<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1 , user-scalable=no">
    <title>海豚战报-web</title>
    <link rel="stylesheet" href="../css/bootstrap.min.css"/>
    <link rel="stylesheet" href="../css/flipclock.css"/>
    <link rel="stylesheet" href="../css/animate.css"/>
    <link rel="stylesheet" href="../css/bootstrap-ht.css"/>
    <link rel="stylesheet" href="../css/bootstrap-ht-full.css"/>
</head>
<body>

<!--home-->
<section id="main">
    <div class="container">
        <div class="text-right"><span id="current_date"></span>
            &nbsp;&nbsp;&nbsp;<a id="refresh"><span class="glyphicon glyphicon-refresh"
                                                    aria-hidden="true"></span></a>
            &nbsp;&nbsp;&nbsp;<a id="full_screen" title="全屏"><span class="glyphicon glyphicon-send"
                                                                   aria-hidden="true"></span></a>
        </div>
        <div class="row wow fadeInUp" data-wow-duration="1s" data-wow-delay="1s" style="text-align: center">
            <div class="col-md-4">
                <div class="row wow bounceIn" data-wow-duration="1s" data-wow-delay="1.5s"
                     style="text-align: center">
                    <div class="col-md-12">
                        <div id="category_chart" style="width: 100%;height: 300px;"></div>
                    </div>
                </div>
                <div id="single_product">
                    <div class="row text-left wow fadeInDown" data-wow-duration="1s" data-wow-delay="1.5s" >
                        <h3>单品销量排名(TOP10)</h3>
                        <ul id="sku_num_top10">
                        </ul>
                    </div>
                    <div class="row text-left wow fadeInLeft" data-wow-duration="1s" data-wow-delay="1.5s" >
                        <h3>单品销售额排名(TOP10)</h3>
                        <ul id="sku_total_top10">
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="row wow fadeInUp" data-wow-duration="1s" data-wow-delay="1s" style="text-align: center">
                    <div class="col-md-12">
                        <div class="clock wow jello " data-wow-duration="1s" data-wow-delay="2s"></div>
                        <h3>今日成交订单数: <span id="today_order_total_num" class="num_tips">0</span></h3>
                        <h3>今日成交额: ¥ <span id="today_order_total_price" class="num_tips">0.00</span></h3>
                    </div>
                </div>
                <div class="row wow fadeInDownBig" data-wow-duration="1s" data-wow-delay="1.5s"
                     style="text-align: center">
                    <div class="col-md-12">
                        <div id="order_distribute_chart" style="width: 100%;height:500px;"></div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="row wow fadeInRight" data-wow-duration="1s" data-wow-delay="1.5s"
                     style="text-align: center">
                    <div class="col-md-12 text-left tj_header">
                        海豚官网 &nbsp;&nbsp;&nbsp;今日PV:<span id="today_pv" class="num_tips"></span>&nbsp;&nbsp;&nbsp;今日UV:<span
                            id="today_uv" class="num_tips"></span>
                    </div>
                </div>
                <div class="row wow fadeInRight" data-wow-duration="1s" data-wow-delay="1.5s"
                     style="text-align: center">
                    <div class="col-md-12">
                        <div id="pv_chart_1" style="width: 100%;height: 350px;"></div>
                    </div>
                </div>
                <div class="row wow fadeInUp" data-wow-duration="1s" data-wow-delay="1.5s"
                     style="text-align: center">
                    <div class="col-md-12">
                        <div id="pv_chart_2" style="width: 100%;height: 350px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!--home-->
<!--footer-->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <p>
                    Copyright&nbsp;©&nbsp;2018&nbsp;&nbsp;海豚跨境科技（香港）有限公司&nbsp;&nbsp;
                </p>
            </div>
        </div>
    </div>
</footer>
<!--footer-->
</body>
<script src="../js/jquery.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/wow.min.js"></script>
<script src="../js/accounting.min.js"></script>
<script src="../js/flipclock.min.js"></script>
<script src="../js/jquery.countup.js"></script>
<script src="../js/chart_option.js"></script>
<script src="../js/echarts.min.js"></script>
<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>
<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
<script>

    var get_now_format_date = function () {
        var date = new Date();
        var seperator1 = "-";
        var year = date.getFullYear();
        var month = date.getMonth() + 1;
        var strDate = date.getDate();
        if (month >= 1 && month <= 9) {
            month = "0" + month;
        }
        if (strDate >= 0 && strDate <= 9) {
            strDate = "0" + strDate;
        }
        return year + seperator1 + month + seperator1 + strDate;
    }

    // 判断各种浏览器，找到正确的方法
    var launch_full_screen = function (element) {
        if (element.requestFullscreen) {
            element.requestFullscreen();
        } else if (element.mozRequestFullScreen) {
            element.mozRequestFullScreen();
        } else if (element.webkitRequestFullscreen) {
            element.webkitRequestFullscreen();
        } else if (element.msRequestFullscreen) {
            element.msRequestFullscreen();
        }
    }

    var exit_fulls_screen = function () {
        if (document.exitFullscreen) {
            document.exitFullscreen();
        } else if (document.mozCancelFullScreen) {
            document.mozCancelFullScreen();
        } else if (document.webkitExitFullscreen) {
            document.webkitExitFullscreen();
        }
    }

    var init_chart = function () {
        //初始化e_chart
        var pv_chart_1 = echarts.init(document.getElementById('pv_chart_1'));
        var pv_chart_2 = echarts.init(document.getElementById('pv_chart_2'));
        var category_chart = echarts.init(document.getElementById('category_chart'));
        var order_distribute_chart = echarts.init(document.getElementById('order_distribute_chart'));
        pv_chart_1.showLoading();
        pv_chart_2.showLoading();
        category_chart.showLoading();
        order_distribute_chart.showLoading();
        $.ajax({
            type: "post",
            url: "http://erp.haitungongyinglian.hk/open/chart",
            dataType: "jsonp",
            jsonp: "callback",//传递给请求处理程序或页面的，用以获得jsonp回调函数名的参数名(默认为:callback)
            async: false,
            success: function (json) {
                pv_chart_1.hideLoading();
                pv_chart_2.hideLoading();
                category_chart.hideLoading();
                order_distribute_chart.hideLoading();
                var chart_data = json;
                //初始化数量
                var today_order_total_price = accounting.formatMoney(chart_data.order_total, '');
                var today_order_total_num = chart_data.order_num;
                $("#today_order_total_price").html(today_order_total_price);
                $("#today_order_total_num").html(today_order_total_num);
                $("#today_order_total_price,#today_order_total_num").countUp({
                    delay: 5,
                    time: 200
                });
                $("#today_pv").html(chart_data.baidu_tj.today_pv);
                $("#today_uv").html(chart_data.baidu_tj.today_uv);

                //top10
                render_top10(chart_data.sku_num_top10,chart_data.sku_total_top10);

                //地图 区域分布
                var order_distribute_chart_option = get_order_distribute_chart_option(chart_data.city_min_num, chart_data.city_max_num, chart_data.map_data);
                order_distribute_chart.setOption(order_distribute_chart_option);
                //折线(pv uv)
                var axis_label = chart_data.baidu_tj.xAxis_name;
                var option_pv = get_tj_chart_option('网站PV', axis_label, chart_data.baidu_tj.xAxis_key, chart_data.baidu_tj.today_info.pv, chart_data.baidu_tj.yesterday_info.pv);
                pv_chart_1.setOption(option_pv);
                var option_uv = get_tj_chart_option('网站UV', axis_label, chart_data.baidu_tj.xAxis_key, chart_data.baidu_tj.today_info.uv, chart_data.baidu_tj.yesterday_info.uv);
                pv_chart_2.setOption(option_uv);

                //类目
                var category_chart_option = get_category_chart_option(chart_data.category);
                category_chart.setOption(category_chart_option);
            },
            error: function () {
                alert('接口异常');
            }
        });
    }

    //self.setInterval("init_chart()", 60000);

    $(function () {
        new WOW().init();
        //初始化时间
        var date = new Date();
        var clock = $('.clock').FlipClock(date, {
            clockFace: 'TwentyFourHourClock'
        });
        $(window).on('load', function () {
            init_chart();
            $("#current_date").text(get_now_format_date())
        })
        $("#refresh").on('click', function () {
            init_chart();
        })

        $("#full_screen").on('click', function () {
            launch_full_screen(document.documentElement); // 整个网页
        })
    })

</script>
</html>